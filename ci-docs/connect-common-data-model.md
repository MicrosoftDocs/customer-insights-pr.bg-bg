---
title: Свържете с папка на Common Data Model с помощта на акаунт в Azure Data Lake
description: Работа с данни от Common Data Model с помощта на Azure Data Lake Storage.
ms.date: 07/27/2022
ms.topic: how-to
author: mukeshpo
ms.author: mukeshpo
ms.reviewer: v-wendysmith
manager: shellyha
searchScope:
- ci-data-sources
- ci-create-data-source
- ci-attach-cdm
- customerInsights
ms.openlocfilehash: b237c291bb4dd22ca22ab2cdd8b6293490aa83e1
ms.sourcegitcommit: 49394c7216db1ec7b754db6014b651177e82ae5b
ms.translationtype: MT
ms.contentlocale: bg-BG
ms.lasthandoff: 08/10/2022
ms.locfileid: "9245772"
---
# <a name="connect-to-data-in-azure-data-lake-storage"></a>Свързване към данни в Azure Data Lake Storage

Въвеждане на данни в Dynamics 365 Customer Insights използването на профила ви Azure Data Lake Storage gen2. Поглъщането на данни може да бъде пълно или постъпково.

## <a name="prerequisites"></a>Предварителни изисквания

- Поглъщането на данни поддържа Azure Data Lake Storage *Gen2* акаунти изключително. Не можете да използвате акаунти в Data Lake Storage Gen1, за да почнете данни.

- Акаунтът Azure Data Lake Storage трябва да има [йерархично пространство на имената разрешено](/azure/storage/blobs/data-lake-storage-namespace). Данните трябва да се съхраняват във формат на йерархична папка, който определя главната папка и има подпапки за всеки обект. Подпапките могат да имат пълни данни или постъпково папки с данни.

- За да се удостоверите с принципал на услуга на Azure, уверете се, че е конфигуриран във вашия клиент. За повече информация вижте [Свързване с Azure Data Lake Storage gen2 акаунт с принципал](connect-service-principal.md) на услугата на Azure.

- The Azure Data Lake Storage искате да свържете и да се внедредят данни от трябва да бъде в същия регион на Azure като околната Dynamics 365 Customer Insights среда. Не се поддържат връзки към папка на Common Data Model от хранилището с данни в различен регион на Azure. За да знаете Региона на Azure на средата, отидете **на Администратор** > **система** > **за** в Клиентски прозрения.

- Данните, съхранявани в онлайн услуги, могат да се съхраняват на различно място от това, където данните се обработват или съхраняват в Dynamics 365 Customer Insights.Чрез импортирането или свързването с данни, съхранявани в онлайн услуги, Вие се съгласявате, че данните могат да бъдат прехвърляни на и съхранявани с Dynamics 365 Customer Insights. [Научете повече в центъра](https://www.microsoft.com/trust-center) за сигурност на Microsoft.

- Директорът на услугата "Аналитични данни за клиенти" трябва да бъде в една от следните роли за достъп до акаунта за съхранение. За повече информация вижте [Предоставяне на разрешения на главницата на услугата за достъп до акаунта](connect-service-principal.md#grant-permissions-to-the-service-principal-to-access-the-storage-account) за съхранение.
  - Четец на данни за съхранение в Blob
  - Собственик на данни за съхранение в Blob
  - Сътрудник за данни за BLOB за съхранение

- Данните във Вашето хранилище на данни езеро трябва да следват стандарта Common Data Model за съхранение на вашите данни и да имат общия манифест на модела на данни, за да представят схемата на файловете с данни (*.csv или *.паркет). Манифестът трябва да предостави подробностите за обектите като колони на обекти и типове данни, както и местоположението на файла с данни и типа на файла. За повече информация вижте [Манифеста](/common-data-model/sdk/manifest) общ модел данни. Ако манифестът не присъства, Администратор потребителите със Съхранение Blob Data Owner или Съхранение Blob Data Contributor достъп може да определи схемата при поглъщане на данните.

## <a name="connect-to-azure-data-lake-storage"></a>Свързване с Azure Data Lake Storage

1. Отидете на **Данни** > **Източници на данни**.

1. Изберете **Добавяне на източник на данни**.

1. Изберете **Хранилище** на езерото за данни на Azure.

   :::image type="content" source="media/data_sources_ADLS.png" alt-text="Диалогов прозорец, за да въведете подробности за връзката за Azure Data Lake." lightbox="media/data_sources_ADLS.png":::

1. Въведете **Име** за източник на данни и незадължително **Описание**. Името идентифицира еднозначно източник на данни и е посочено в процеси надолу по веригата и не може да се променя.

1. Изберете една от следните опции за Свързване на вашето място за **съхранение, като** използвате. За повече информация вижте [Свързване на аналитични данни за клиенти към Azure Data Lake Storage gen2 акаунт с принципал](connect-service-principal.md) на услугата на Azure.

   - **Azure ресурс**: Въведете ИД **на** ресурс. По желание, ако искате да почнете данни от акаунт за съхранение чрез частна връзка на Azure, изберете **Разрешаване на частна връзка**. За повече информация вижте [Частни връзки](security-overview.md#set-up-an-azure-private-link).
   - **Абонамент за** Azure: Изберете абонамента **и** след това **групата** ресурси и **акаунта** за съхранение. По желание, ако искате да почнете данни от акаунт за съхранение чрез частна връзка на Azure, изберете **Разрешаване на частна връзка**. За повече информация вижте [Частни връзки](security-overview.md#set-up-an-azure-private-link).
  
   > [!NOTE]
   > Нуждаете се от една от следните роли или на контейнера, или на акаунта за съхранение, за да създадете източник на данни:
   >
   >  - Съхранение Blob Четец на данни е достатъчен, за да прочетете от акаунт за съхранение и да почнете данните към Customer Insights. 
   >  - Съхранение Blob Данни Сътрудник или Собственик е необходимо, ако искате да редактирате манифестните файлове директно в Customer Insights.  
  
1. Изберете името на **Контейнера**, който съдържа данните и схемата (model.json или manifest.json файл), от който да импортирате данни, и изберете **Напред**.
   > [!NOTE]
   > Всеки файл model.json или manifest.json, свързан с друг източник на данни в средата, няма да се показва в списъка. Същият файл model.json или manifest.json обаче може да се използва за източници на данни в множество среди.

1. За да създадете нова схема, отидете [на Създаване на нов файл](#create-a-new-schema-file) на схема.

1. За да използвате съществуваща схема, навигирайте до папката, съдържаща файла model.json или manifest.cdm.json. Можете да търсите в рамките на директория, за да намерите файла.

1. Изберете файла json и изберете **Напред**. Списък на наличните обекти показва.

   :::image type="content" source="media/review-entities.png" alt-text="Диалогов прозорец на списък с обекти, за да изберете":::

1. Изберете обектите, които искате да включите.

   :::image type="content" source="media/ADLS_required.png" alt-text="Диалогов прозорец, показващ Задължителен за Основен ключ":::

   > [!TIP]
   > За да редактирате обект в интерфейс за редактиране на JSON, изберете обекта и след това **Редактирайте файла на схемата**. Направете промени и изберете **Запиши**.

1. За избрани обекти, които изискват постъпково поглъщане, **Задължителни** дисплеи под **Постъпково обновяване**. За всеки от тези обекти вижте [Конфигуриране на постъпково обновяване за източниците](incremental-refresh-data-sources.md) на данни на Azure Data Lake.

1. За избрани обекти, където не е дефиниран първичен ключ, **"Задължителни** " показва под **Основен ключ**. За всеки от тези субекти:
   1. Изберете **Задължително**. Панелът **Редактиране на обект** показва.
   1. Изберете първичния **ключ**. Основният ключ е атрибут, уникален за обекта. За да бъде атрибутът валиден първичен ключ, той не трябва да включва дублирани стойности, липсващи стойности или нулеви стойности. Низ, цяло число и GUID тип данни атрибути се поддържат като основни ключове.
   1. По желание променете модела на дяла.
   1. Изберете **Затвори**, за да запишете и затворите панела.

1. Изберете броя **Атрибути** за всеки включен обект. **Страницата Управление на атрибути** показва.

   :::image type="content" source="media/dataprofiling-entities.png" alt-text="Диалогов прозорец, за да изберете профилиране на данни.":::

   1. Създаване на нови атрибути, редактиране или изтриване на съществуващи атрибути. Можете да промените името, формата на данните или да добавите семантичен тип.
   1. За да разрешите анализ и други възможности, изберете **Профилиране** на данни за целия обект или за конкретни атрибути. По подразбиране не е разрешен обект за профилиране на данни.
   1. Изберете **Готово**.

1. Изберете **Записване**. **Отваря се страницата източници на данни**, показваща новия източник на данни в **състояние "Обновяване**".

   [!INCLUDE [progress-details-include](includes/progress-details-pane.md)]

Зареждането на данни може да отнеме време. След успешно обновяване, най-търсените данни могат да бъдат прегледани от [**страницата Обекти**](entities.md).

### <a name="create-a-new-schema-file"></a>Създаване на нов файл със схеми

1. Изберете **Нов файл** на схема.

1. Въведете име за файла и изберете **Запиши**.

1. Изберете **Нов обект**. Панелът **"Нов обект** " показва.

1. Въведете името на обекта и изберете местоположението **на** файловете с данни.
   - **Няколко .csv или .parquet файлове**: Прегледайте главната папка, изберете типа модел и въведете израза.
   - **Единични .csv или .parquet файлове**: Прегледайте файла .csv или .parquet и го изберете.

   :::image type="content" source="media/ADLS_new_entity_location.png" alt-text="Диалогов прозорец за създаване на нов обект с маркирано местоположение на файлове с данни.":::

1. Изберете **Записване**.

   :::image type="content" source="media/ADLS_new_entity_define_attributes.png" alt-text="Диалогов прозорец за дефиниране или автоматично генериране на атрибути.":::

1. Изберете **дефиниране на атрибутите** за ръчно добавяне на атрибутите или изберете **автоматичното им** генериране. За да определите атрибутите, въведете име, изберете формата на данните и незадължителния семантичен тип. За автоматично генерирани атрибути:

   1. След като атрибутите са автоматично генерирани, изберете **Преглед на** атрибути. **Страницата Управление на атрибути** показва.

   1. Гарантирайте, че форматът на данните е правилен за всеки атрибут.

   1. За да разрешите анализ и други възможности, изберете **Профилиране** на данни за целия обект или за конкретни атрибути. По подразбиране не е разрешен обект за профилиране на данни.

      :::image type="content" source="media/dataprofiling-entities.png" alt-text="Диалогов прозорец, за да изберете профилиране на данни.":::

   1. Изберете **Готово**. Страницата **Избор на обекти** показва.

1. Продължете да добавяте обекти и атрибути, ако е приложимо.

1. След като всички обекти са добавени, изберете **Включване**, за да включите обектите в източник на данни поглъщане.

   :::image type="content" source="media/ADLS_required.png" alt-text="Диалогов прозорец, показващ Задължителен за Основен ключ":::

1. За избрани обекти, които изискват постъпково поглъщане, **Задължителни** дисплеи под **Постъпково обновяване**. За всеки от тези обекти вижте [Конфигуриране на постъпково обновяване за източниците](incremental-refresh-data-sources.md) на данни на Azure Data Lake.

1. За избрани обекти, където не е дефиниран първичен ключ, **"Задължителни** " показва под **Основен ключ**. За всеки от тези субекти:
   1. Изберете **Задължително**. Панелът **Редактиране на обект** показва.
   1. Изберете първичния **ключ**. Основният ключ е атрибут, уникален за обекта. За да бъде атрибутът валиден първичен ключ, той не трябва да включва дублирани стойности, липсващи стойности или нулеви стойности. Низ, цяло число и GUID тип данни атрибути се поддържат като основни ключове.
   1. По желание променете модела на дяла.
   1. Изберете **Затвори**, за да запишете и затворите панела.

1. Изберете **Записване**. **Отваря се страницата източници на данни**, показваща новия източник на данни в **състояние "Обновяване**".

   [!INCLUDE [progress-details-include](includes/progress-details-pane.md)]

Зареждането на данни може да отнеме време. След успешно обновяване, най-търсените данни могат да бъдат прегледани от [**страницата Обекти**](entities.md).

## <a name="edit-an-azure-data-lake-storage-data-source"></a>Редактиране на Azure Data Lake Storage източник на данни

Можете да актуализирате *опцията Свързване към акаунта за съхранение с помощта на* опцията. За повече информация вижте [Свързване на аналитични данни за клиенти към Azure Data Lake Storage gen2 акаунт с принципал](connect-service-principal.md) на услугата на Azure. За да се свържете с различен контейнер от акаунта за съхранение или да промените името на акаунта, трябва [да създадете нова връзка с източник на данни](#connect-to-azure-data-lake-storage).

1. Отидете на **Данни** > **Източници на данни**.

1. До източник на данни, които бихте искали да актуализирате, изберете **Редактиране**.

   :::image type="content" source="media/data_sources_edit_ADLS.png" alt-text="Диалогов прозорец за редактиране на Azure data Lake източник на данни.":::

1. Променете някоя от следните сведения:

   - **Описание**
   - **Свържете вашето място за съхранение с помощта** и информацията за връзката. Не можете да се промените информацията **Контейнер** при актуализиране на връзката.
      > [!NOTE]
      > Една от следните роли трябва да бъде присвоена на акаунта или контейнера за съхранение:
        > - Четец на данни за съхранение в Blob
        > - Собственик на данни за съхранение в Blob
        > - Сътрудник за данни за BLOB за съхранение

   - **Разрешаване на частна връзка**, ако искате да почнете данни от акаунт за съхранение чрез azure частна връзка. За повече информация вижте [Частни връзки](security-overview.md#set-up-an-azure-private-link).

1. Изберете **Напред**.
1. Променете някое от следните неща:
   - Навигирайте до различен файл model.json или manifest.json с различен набор от обекти от контейнера.
   - За да добавите допълнителни обекти към ingest, изберете **Нов обект**.
   - За да премахнете всички вече избрани обекти, ако няма зависимости, изберете обекта и **Изтрий**.
      > [!IMPORTANT]
      > Ако има зависимости от съществуващия файл model.json или manifest.json и набора от обекти, ще видите съобщение за грешка и не можете да изберете различен файл model.json или manifest.json. Премахнете тези зависимости, преди да промените файла model.json или manifest.json или създайте нов източник на данни с файла model.json или manifest.json, който искате да използвате, за да избегнете премахването на зависимостите.
   - За да промените местоположението на файла с данни или основния ключ, изберете **Редактиране**.
   - За да промените данните за постъпково поглъщане, вижте [Конфигуриране на постъпково обновяване за източниците на данни на Azure Data Lake](incremental-refresh-data-sources.md).
   - Променете името на обекта само така, че да съответства на името на обекта във файла .json.

     > [!NOTE]
     > Винаги съхранявайте името на обекта в "Аналитични данни за клиенти" същото като името на обекта вътре във файла model.json или manifest.json след поглъщане. Customer Insights валидира всички имена на обект с model.json или manifest.json по време на всяко обновяване на системата. Ако името на обект се променя или вътре в "Аналитични данни за клиенти", или извън него, възниква грешка, защото "Аналитични данни за клиенти" не може да намери новото име на обект във файла .json. Ако случайно е променено име на поглъщане на обект, редактирайте името на обекта в "Статистика за клиенти", така че да съответства на името във файла .json.

1. Изберете **Атрибути** за добавяне или промяна на атрибути или за разрешаване на профилиране на данни. След това изберете **Готово**.

1. Кликнете върху **Запиши**, за да приложите промените си и да се върнете към страницата източници на **данни**.

   [!INCLUDE [progress-details-include](includes/progress-details-pane.md)]

[!INCLUDE [footer-include](includes/footer-banner.md)]
